---
layout: mathpost
---

# 泊松分布与女儿发烧 #

概率论只不过是把常识用数学公式表达了出来。——拉普拉斯<br/>
“常识”无法教给计算机，而“数学公式”可以。——Jingwei6

泊松分布的由来 

泊松分布由二项分布的极限得到。<br/>
二项分布描述了n次实验中概率为p的某事件出现k次的概率，用公式表示为：

$$b(k;n,p)={k \choose n} p^{k} (1-p)^{n-k} \tag{1}$$

有两种推导方法从上述二项分布得到泊松分布，分别是对n取极限和对p取极限。

对n取极限的详细推导方法请参考“参考资料1”。该方法的思想是把实验的时间分成n段，
每段时间是${\frac 1n}$，那么某事件发生的概率p一定是跟这个时间段成正比，假设这个比例是${\lambda}$，也就是说有：

$$p={\frac {\lambda}n} \tag{2}$$

把（2）式代入（1），并对$n \to \infty$求极限，即得到泊松分布公式：

$$P_{k}= \frac{ e^{-\lambda} {\lambda}^{k} } { k! } \tag{3}$$

对p取极限的详细推导方法请参考“参考资料2”。该方法是将（1）式展开变形，并取$p \to 0$求极限。

$n \to \infty$的推导方法的意义在于，它说明泊松分布适用于实验条件可以无限细分的情况，比如时间。<br/>
$p \to 0$的推导方法的意义在于，它说明泊松分布适用于小概率事件。<br/>
而${\lambda}=np$（见上2），可理解为某段时间内事件出现的平均次数。

以jingwei6的女儿发烧次数作为例子来说，她快3岁了，发烧3次，平均每年发烧1次，可认为${\lambda}=1$，
那么她每年发烧的次数的概率就应该服从${\lambda}=1$的泊松分布，即下图红色线条所示：

![lambda=1,4,10的泊松分布表](/images/Poisson_distribution_right.jpg)

从上图可以看出，每年不发烧的概率为0.37，发一次烧的概率也为0.37，发两次烧的概率为0.18，
所以发烧次数小于等于两次的累计概率为0.37+0.37+0.18=0.92，也就是说，大多数情况下，她每年发烧的次数应该小于3次，
否则我会怀疑有其他的不正常原因导致她生病发烧。

上述不发烧的概率和发一次烧的概率相等并非偶然。${\lambda}$取K的泊松分布中，事件出现K次和出现K-1次的概率必然是相等的。
把${\lambda}$=K和k=K代入（3）式：

$$P(K)=e^{-K}\frac{ {K}^{K} } { K! }=e^{-K}\frac{ {K}^{K-1} K } { (K-1)! K }=e^{-K}\frac{ {K}^{K-1} } { (K-1)!}=P(K-1)$$

这可以从上图中${\lambda}$=4和${\lambda}$=10的分布函数得到印证。

而${\lambda}$取K的泊松分布中，事件出现K+1次的概率：

$$P(K+1)=e^{-K}\frac{ {K}^{K+1} } { (K+1)! }=e^{-K}\frac{ {K}^{K} K } { K! (K+1) }=\frac{K}{K+1} P(K)$$

因为$\frac{K}{K+1}<1$，所以P(K+1)一定比P(K)小。
同理可证P(K-2)<P(K-1)。<br/>
由数学归纳法可证得：${\lambda}$取K的泊松分布中，事件出现K次和出现K-1次的概率最大。<br/>
用常识来解释上述推理就是，如果某事件平均出现K次，那么在真实情况下它出现K次的可能性就是最大的。<br/>
这也印证了是本文开头拉普拉斯说的那句话。

---
参考资料：

1. <概率论与数理统计> 陈希孺
2. [泊松分布](http://blog.chengyichao.info/2011/05/03/poisson-distribution/) chengyichao
